<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fuel Station Calc</title>
    <link rel="icon" type="image/png" href="https://cdn-icons-png.flaticon.com/512/888/888846.png">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/888/888846.png">
    
    <style>
        :root { --display-bg: #000; --led-red: #ff3b30; --led-green: #4cd964; --led-yellow: #ffcc00; }
        body { font-family: 'Courier New', monospace; background: #222; display: flex; justify-content: center; padding: 10px; margin: 0; color: white; }
        
        .pump-body { 
            background: #333; border: 6px solid #111; border-radius: 20px; padding: 20px; 
            width: 100%; max-width: 380px; box-shadow: 0 10px 30px rgba(0,0,0,0.8);
        }

        /* Горни настройки на цените - остават за справка, но не се попълват автоматично */
        .settings-panel { 
            background: #444; padding: 10px; border-radius: 10px; margin-bottom: 15px; 
            display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 5px; border: 1px solid #555;
        }
        .settings-panel div { text-align: center; font-size: 10px; color: #aaa; }
        .settings-panel input { 
            width: 100%; background: #222; border: 1px solid #666; color: var(--led-yellow); 
            text-align: center; padding: 5px 0; font-size: 14px; border-radius: 5px;
        }

        .fuel-selector { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .f-btn { padding: 15px 5px; border-radius: 8px; border: none; cursor: pointer; font-weight: bold; font-size: 11px; color: white; transition: 0.3s; }
        .a95 { background: #006400; border: 2px solid #008000; }
        .diesel { background: #111; border: 2px solid #444; }
        .lpg { background: #d35400; border: 2px solid #e67e22; }

        .display-unit { background: var(--display-bg); border-radius: 10px; padding: 12px; border: 3px inset #222; margin-bottom: 10px; transition: background-color 0.4s ease; }
        label { display: block; font-size: 11px; color: #666; text-transform: uppercase; margin-bottom: 3px; }
        .main-input { width: 100%; background: transparent; border: none; color: var(--led-yellow); font-size: 30px; text-align: right; outline: none; }

        .res-area { background: #000; padding: 15px; border-radius: 8px; border: 2px solid #222; }
        .val-eur { color: var(--led-red); font-size: 34px; font-weight: bold; display: block; text-align: right; }
        .val-bgn { color: var(--led-green); font-size: 24px; font-weight: bold; display: block; text-align: right; }

        .clear-btn { width: 100%; padding: 12px; background: #500; color: white; border: none; border-radius: 5px; margin-top: 15px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>

<div class="pump-body">
    <div style="text-align:center; color:#777; font-size:12px; margin-bottom:10px;">БЪРЗ ИЗБОР НА ГОРИВО</div>
    
    <div class="fuel-selector">
        <button class="f-btn a95" onclick="changeColor('#006400')">A95H</button>
        <button class="f-btn diesel" onclick="changeColor('#111')">DIESEL</button>
        <button class="f-btn lpg" onclick="changeColor('#d35400')">LPG</button>
    </div>

    <div class="display-unit" id="eurBox">
        <label id="eurLabel">Цена в Евро (€)</label>
        <input type="number" id="pEur" class="main-input" placeholder="0.00" inputmode="decimal" oninput="run()">
    </div>

    <div class="display-unit">
        <label>Платено в Лева (лв)</label>
        <input type="number" id="pBgn" class="main-input" placeholder="0.00" inputmode="decimal" oninput="run()">
    </div>

    <div class="res-area" id="out" style="opacity: 0.3;">
        <label>Ресто в EUR</label>
        <span class="val-eur" id="re">0.00</span>
        <label>Ресто в BGN</label>
        <span class="val-bgn" id="rb">0.00</span>
    </div>

    <button class="clear-btn" onclick="cls()">RESET / ИЗЧИСТИ</button>

    <div style="margin-top:15px; font-size:10px; color:#555; text-align:center;">
        Настройки на цените се пазят автоматично.
    </div>
</div>

<script>
    const R = 1.95583;

    // Смяна само на цвета на полето без промяна на сумата
    function changeColor(color) {
        document.getElementById('eurBox').style.backgroundColor = color;
        document.getElementById('eurLabel').style.color = '#fff';
        document.getElementById('pEur').focus(); // Автоматично насочва към писане
    }

    function run() {
        let e = parseFloat(document.getElementById('pEur').value) || 0;
        let b = parseFloat(document.getElementById('pBgn').value) || 0;
        let out = document.getElementById('out');

        if (e <= 0 || b <= 0) { out.style.opacity = "0.3"; return; }

        let chE = (b / R) - e;
        if (chE < 0) {
            out.style.opacity = "0.3";
        } else {
            out.style.opacity = "1";
            document.getElementById('re').innerText = chE.toFixed(2);
            document.getElementById('rb').innerText = (chE * R).toFixed(2);
        }
    }

    function cls() {
        document.getElementById('pEur').value = '';
        document.getElementById('pBgn').value = '';
        document.getElementById('out').style.opacity = "0.3";
        document.getElementById('eurBox').style.backgroundColor = "#000";
        document.getElementById('eurLabel').style.color = '#666';
        document.getElementById('re').innerText = "0.00";
        document.getElementById('rb').innerText = "0.00";
    }

    // ОФЛАЙН ПОДДРЪЖКА (Service Worker)
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            const swCode = `
                const cacheName = 'fuel-v8';
                self.addEventListener('install', e => {
                    self.skipWaiting();
                    e.waitUntil(caches.open(cacheName).then(c => c.addAll(['./'])));
                });
                self.addEventListener('fetch', e => e.respondWith(caches.match(e.request).then(r => r || fetch(e.request))));
            `;
            const blob = new Blob([swCode], {type: 'application/javascript'});
            navigator.serviceWorker.register(URL.createObjectURL(blob));
        });
    }
</script>
</body>
</html>
